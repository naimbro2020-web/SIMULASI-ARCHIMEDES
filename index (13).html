<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Hukum Archimedes (Ditambah Grafik)</title>
    
    <style>
        /* [CSS Umum dan Tata Letak (Responsif) - Disesuaikan untuk Grafik] */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
        :root {
            --font-main: 'Poppins', sans-serif;
            --color-bg-light: #f9f9fb;     
            --color-primary-dark: #2c3a4f;  
            --color-secondary-teal: #3498db; 
            --color-accent-gold: #f39c12;   
            --color-text-dark: #34495e;      
            --color-border-light: #ecf0f1;  
            --fall-duration: 1.5s; 
            --fall-timing: cubic-bezier(0.68, -0.55, 0.27, 1.55); 
        }

        body { 
            font-family: var(--font-main);
            background-color: var(--color-bg-light);
            color: var(--color-text-dark);
            margin: 0;
            padding: 30px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            display: flex; 
            width: 100%;
            max-width: 1300px;
            gap: 40px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.08); 
            background-color: white;
            padding: 40px;
            border-radius: 15px;
        }

        .controls {
            width: 400px; 
            padding-right: 30px;
            border-right: 2px solid var(--color-border-light);
            flex-shrink: 0; 
        }

        .simulation-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 300px; 
        }
        
        h2 {
            color: var(--color-primary-dark);
            font-weight: 600;
            font-size: 1.8em;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 8px;
        }
        
        h2::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 40px;
            height: 3px;
            background-color: var(--color-accent-gold);
            border-radius: 2px;
        }

        label {
            display: block;
            margin-top: 20px;
            font-weight: 600;
            color: var(--color-primary-dark);
        }

        select {
            width: 100%;
            padding: 12px;
            margin-top: 8px;
            border: 1px solid var(--color-border-light);
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
            appearance: none; 
            background-image: url('data:image/svg+xml;utf8,<svg fill="%232c3a4f" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
        }

        button {
            width: 100%;
            padding: 12px 15px;
            margin-top: 25px;
            background-color: var(--color-secondary-teal);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: background-color 0.3s;
            box-shadow: 0 4px 6px rgba(52, 152, 219, 0.3);
        }

        /* Gaya Tabel (Teks Biasa) */
        .density-info {
            background-color: #fafafa;
            padding: 15px 5px 15px 15px; 
            border-radius: 8px;
            border: 1px solid var(--color-border-light);
            margin-top: 20px;
            overflow-x: auto; 
        }
        
        .density-info table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            text-align: left;
        }

        .density-info th, .density-info td {
            padding: 8px 12px;
            border-bottom: 1px solid #eee;
            vertical-align: middle;
        }

        .density-info th {
            background-color: #ecf0f1;
            font-weight: 600;
            color: var(--color-primary-dark);
            text-align: center;
        }
        
        /* --- Gaya Grafik Massa Jenis --- */
        .density-graph {
            margin-top: 30px;
            padding: 20px 10px;
            background: linear-gradient(to top, #f0f4f7, #ffffff);
            border-radius: 10px;
            border: 1px solid var(--color-border-light);
            position: relative;
            height: 250px; /* Tinggi total grafik */
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
        }

        .water-line {
            position: absolute;
            /* 1000 / 9000 = ~11.1% dari bawah */
            top: calc(100% - (1000 / 9000) * 100% - 10px); 
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--color-secondary-teal);
            border-top: 1px dashed rgba(52, 152, 219, 0.7);
            z-index: 5;
        }

        .water-label {
            position: absolute;
            top: calc(100% - (1000 / 9000) * 100% - 25px);
            left: 5px;
            font-size: 0.8em;
            font-weight: 600;
            color: var(--color-secondary-teal);
            background-color: white;
            padding: 2px 5px;
            border-radius: 3px;
            border: 1px solid var(--color-secondary-teal);
        }

        .bar-container {
            flex-grow: 1;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            height: 100%;
            margin: 0 4px;
        }

        .bar {
            width: 30px;
            background-color: var(--color-primary-dark);
            transition: height 1.5s ease-out;
            margin-bottom: 5px;
            border-radius: 3px 3px 0 0;
            position: relative;
        }
        
        .bar-label {
            font-size: 0.75em;
            color: var(--color-text-dark);
            font-weight: 500;
            margin-top: 5px;
            width: 100%;
            white-space: nowrap;
        }

        .density-value {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 1px 3px;
            border-radius: 2px;
        }
        
        /* Warna Bar Berdasarkan Status */
        .bar[data-status="float"] { background-color: #4caf50; } /* Hijau */
        .bar[data-status="sink"] { background-color: #f44336; } /* Merah */


        .beaker-container {
            position: relative;
            width: 250px;
            height: 400px;
            border: 3px solid var(--color-primary-dark);
            border-bottom-width: 10px;
            border-radius: 0 0 20px 20px;
            overflow: hidden;
            margin-top: 30px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .water {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 80%;
            background-color: var(--color-secondary-teal);
            opacity: 0.7;
            animation: water-flow 4s infinite alternate; 
        }
        
        @keyframes water-flow {
            from { border-top-left-radius: 5% 20%; border-top-right-radius: 5% 20%; }
            to { border-top-left-radius: 15% 5%; border-top-right-radius: 15% 5%; }
        }

        /* --- Objek Benda & Animasi Jatuh --- */
        .object {
            position: absolute;
            width: 50px;
            height: 50px;
            top: -60px; /* Posisi awal di atas beaker */
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.5s, transform 0.5s, top 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.8);
            z-index: 10;
            touch-action: none;
        }
        
        .object.falling {
            transition: top var(--fall-duration) var(--fall-timing), background-color 0.5s;
        }
        
        /* Gaya Material */
        .object[data-material="kayu-kering"] { background-color: #a0522d; } 
        .object[data-material="kayu-basah"] { background-color: #7d4427; } 
        .object[data-material="plastik"] { background-color: #27ae60; } 
        .object[data-material="tembaga"] { background-color: #c0392b; } 
        .object[data-material="besi"] { background-color: #7f8c8d; } 
        
        .status-box {
            margin-top: 30px;
            padding: 18px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1.1em;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-left: 5px solid var(--color-accent-gold);
        }

        /* --- MEDIA QUERY: Optimasi untuk HP --- */
        @media (max-width: 800px) {
            
            body { padding: 15px; }
            .container { 
                flex-direction: column; 
                gap: 20px; 
                padding: 20px; 
            }
            .controls {
                width: 100%; 
                padding-right: 0; 
                border-right: none;
                border-bottom: 2px solid var(--color-border-light); 
                padding-bottom: 20px;
            }
            .simulation-area { 
                width: 100%; 
                align-items: center; 
            }
            .beaker-container {
                width: 70%; 
                max-width: 250px; 
                height: 300px; 
                margin-top: 20px;
            }
            h2 { font-size: 1.5em; }
            .density-info p { font-size: 0.9em; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="controls">
        <h2>üî¨ Kontrol & Data</h2>
        
        <label for="object-select">Pilih Benda:</label>
        <select id="object-select">
            <option value="kayu-kering">Kayu Kering ü™µ (Mengapung Sangat Tinggi)</option>
            <option value="kayu-basah">Kayu Basah üå≤ (Mengapung Rendah)</option>
            <option option value="plastik">Plastik ‚ôªÔ∏è (Mengapung Jelas di Permukaan)</option>
            <option value="tembaga">Tembaga üß± (Tenggelam)</option>
            <option value="besi">Besi ‚öôÔ∏è (Tenggelam)</option>
        </select>
        
        <button onclick="resetSimulation()">
            Setel Ulang Simulasi
        </button>

        <br>
        
        <h2>üìò Massa Jenis (&rho;)</h2>
        <div class="density-info">
             <table>
                 <thead>
                     <tr>
                         <th>Material</th>
                         <th>Notasi</th>
                         <th>&rho; (kg/m&sup3;)</th>
                     </tr>
                 </thead>
                 <tbody>
                     <tr>
                         <td>Air</td>
                         <td>&rho;<sub>air</sub></td>
                         <td style="text-align: center;">1000</td>
                     </tr>
                     <tr>
                         <td>Kayu Kering</td>
                         <td>&rho;<sub>kering</sub></td>
                         <td style="text-align: center;">&approx; 500</td>
                     </tr>
                     <tr>
                         <td>Kayu Basah</td>
                         <td>&rho;<sub>basah</sub></td>
                         <td style="text-align: center;">&approx; 800</td>
                     </tr>
                     <tr>
                         <td>**Plastik**</td>
                         <td>&rho;<sub>plastik</sub></td>
                         <td style="text-align: center;">&approx; **900**</td>
                     </tr>
                     <tr>
                         <td>Tembaga</td>
                         <td>&rho;<sub>tembaga</sub></td>
                         <td style="text-align: center;">&approx; 8960</td>
                     </tr>
                     <tr>
                         <td>Besi</td>
                         <td>&rho;<sub>besi</sub></td>
                         <td style="text-align: center;">&approx; 7870</td>
                     </tr>
                 </tbody>
             </table>
        </div>
        
        <h2>üìä Grafik Perbandingan Massa Jenis (&rho;)</h2> 
        <div class="density-graph" id="density-graph">
            <div class="water-line"></div>
            <div class="water-label">Batas Air (&rho;=1000)</div> 
            
            </div>

        <div class="status-box" id="status-display">
            Pilih benda untuk melihat hasil simulasi.
        </div>
        
    </div>

    <div class="simulation-area">
        <h2>üåä Simulasi Beaker Air</h2>
        
        <div class="beaker-container" id="beaker-container">
            <div class="water"></div>
            <div class="object" id="sim-object"></div>
        </div>
    </div>
</div>

<script>
    const densities = {
        'air': 1000,
        'kayu-kering': 500, 
        'kayu-basah': 800, 
        'plastik': 900, 
        'tembaga': 8960,
        'besi': 7870
    };

    const objectElement = document.getElementById('sim-object');
    const selectElement = document.getElementById('object-select');
    const beakerContainer = document.getElementById('beaker-container');
    const statusDisplay = document.getElementById('status-display');
    const graphElement = document.getElementById('density-graph'); 
    const root = document.documentElement; 
    
    let beakerHeight = 400; 
    let waterHeight = 320; 
    const objectSize = 50; 
    let waterSurfaceTop = beakerHeight - waterHeight; 
    
    const MAX_DENSITY_SCALE = 9000; 

    // Konstanta Durasi 
    const minDensityValue = 500; 
    const maxDensity = 8960; 
    const minDuration = 1.5; 
    const maxDuration = 2.5; 

    // Konstanta Timing Function
    const timingBounce = 'cubic-bezier(0.68, -0.55, 0.27, 1.55)'; 
    const timingMuted = 'cubic-bezier(0.60, 0.1, 0.30, 1.25)';  
    const timingEaseOut = 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'; 

    function updateDimensions() {
        beakerHeight = beakerContainer.offsetHeight;
        waterHeight = beakerHeight * 0.8;
        waterSurfaceTop = beakerHeight - waterHeight;
    }

    // --- Fungsi Update Grafik ---
    function updateGraph(selectedMaterial) {
        // Hapus bar yang sudah ada
        graphElement.querySelectorAll('.bar-container:not(:first-child)').forEach(node => node.remove());
        
        const materials = ['kayu-kering', 'kayu-basah', 'plastik', 'besi', 'tembaga'];
        
        materials.forEach(material => {
            const density = densities[material];
            const heightPercent = (density / MAX_DENSITY_SCALE) * 100;
            const isFloating = density < densities['air'];
            const status = isFloating ? 'float' : 'sink';
            
            const barContainer = document.createElement('div');
            barContainer.className = 'bar-container';
            
            const bar = document.createElement('div');
            bar.className = 'bar';
            bar.dataset.status = status;
            bar.style.height = `${heightPercent}%`;
            if (material === selectedMaterial) {
                bar.style.border = '2px solid var(--color-accent-gold)';
                bar.style.boxShadow = '0 0 10px var(--color-accent-gold)';
            } else {
                bar.style.border = 'none';
                bar.style.boxShadow = 'none';
            }
            
            const densityValue = document.createElement('span');
            densityValue.className = 'density-value';
            densityValue.textContent = density;
            
            const label = document.createElement('span');
            label.className = 'bar-label';
            
            // Format label
            if (material === 'kayu-kering') label.textContent = 'Kayu Kering';
            else if (material === 'kayu-basah') label.textContent = 'Kayu Basah';
            else if (material === 'plastik') label.textContent = 'Plastik';
            else if (material === 'besi') label.textContent = 'Besi';
            else if (material === 'tembaga') label.textContent = 'Tembaga';
            
            bar.appendChild(densityValue);
            barContainer.appendChild(bar);
            barContainer.appendChild(label);
            graphElement.appendChild(barContainer);
        });
    }

    // --- Fungsi Utama Simulasi ---
    function simulateArchimedes(material) {
        updateDimensions(); 
        
        const rho_fluid = densities['air'];
        const rho_object = densities[material];
        
        objectElement.dataset.material = material;
        
        // 1. Tentukan Durasi & Timing Function
        const normalizedRhoForDuration = (rho_object - minDensityValue) / (maxDensity - minDensityValue); 
        let fallDuration = maxDuration - (normalizedRhoForDuration * (maxDuration - minDuration));
        fallDuration = Math.max(minDuration, Math.min(fallDuration, maxDuration)); 
        
        let finalY; 
        let statusText = "";
        let statusBgColor, statusBorderColor;
        let selectedTiming;
        
        if (rho_object < rho_fluid) { // Mengapung (Floating)
            const submergedRatio = rho_object / rho_fluid; 
            const visibleHeight = (1 - submergedRatio) * objectSize;
            
            finalY = waterSurfaceTop - visibleHeight; 

            if (material === 'kayu-kering') {
                selectedTiming = timingBounce; 
                statusText = `‚úÖ **Mengapung Sangat Tinggi!** (${((1 - submergedRatio) * 100).toFixed(1)} % di atas air)`;
                statusBgColor = "#e8f5e9";
                statusBorderColor = "#4caf50";
            
            } else if (material === 'kayu-basah') {
                selectedTiming = timingMuted; 
                statusText = `‚ö†Ô∏è **Mengapung Rendah!** (${((1 - submergedRatio) * 100).toFixed(1)} % di atas air)`;
                statusBgColor = "#fff8e1";
                statusBorderColor = "#ffb300";

            } else if (material === 'plastik') {
                selectedTiming = timingMuted; 
                statusText = `‚ö†Ô∏è **Mengapung Jelas di Permukaan!** (${((1 - submergedRatio) * 100).toFixed(1)} % di atas air)`;
                statusBgColor = "#fff8e1";
                statusBorderColor = "#ffb300";
            }
        
        } else { // Tenggelam (Sinking)
            selectedTiming = timingEaseOut; 
            finalY = beakerHeight - objectSize; 
            statusText = `‚ùå **Tenggelam!**`;
            statusBgColor = "#ffebee";
            statusBorderColor = "#f44336";
        }
        
        // Update GRAFIK
        updateGraph(material);
        
        // Terapkan durasi & timing ke variabel CSS
        root.style.setProperty('--fall-duration', `${fallDuration.toFixed(2)}s`);
        root.style.setProperty('--fall-timing', selectedTiming);
        
        // 2. Reset Posisi ke Atas Secara Instan
        objectElement.style.transition = 'none'; 
        objectElement.classList.remove('falling');
        objectElement.style.top = `${-objectSize}px`; 
        void objectElement.offsetWidth; 
        objectElement.style.transition = ''; 

        
        // 3. Mulai animasi jatuh
        setTimeout(() => {
             objectElement.classList.add('falling'); 
             objectElement.style.top = `${finalY}px`; 
             objectElement.style.zIndex = (finalY < waterSurfaceTop) ? '10' : '5'; 
        }, 50); 

        // 4. Hapus kelas 'falling' setelah animasi selesai
        setTimeout(() => {
             objectElement.classList.remove('falling');
        }, fallDuration * 1000 + 50); 

        // Update status box styling
        statusDisplay.style.backgroundColor = statusBgColor;
        statusDisplay.style.borderLeftColor = statusBorderColor;
        statusDisplay.style.color = statusBorderColor;
        statusDisplay.innerHTML = statusText + `<br> (œÅ Benda: **${rho_object} kg/m¬≥**) <br> Durasi Jatuh: ${fallDuration.toFixed(2)}s`;
    }
    
    // --- Event Listener dan Reset ---
    selectElement.addEventListener('change', (e) => {
        simulateArchimedes(e.target.value); 
    });
    
    function resetSimulation() {
        selectElement.value = "kayu-kering"; 
        objectElement.dataset.material = "kayu-kering"; 
        
        statusDisplay.innerHTML = "Pilih benda untuk melihat hasil simulasi.";
        statusDisplay.style.backgroundColor = "#ecf0f1";
        statusDisplay.style.borderLeftColor = "var(--color-accent-gold)";
        statusDisplay.style.color = "var(--color-text-dark)";
        
        setTimeout(() => simulateArchimedes("kayu-kering"), 100); 
    }

    window.addEventListener('resize', () => { resetSimulation(); });
    resetSimulation();
    
    // --- Logika Drag/Drop Tambahan (Opsional) ---
    let isDragging = false;
    let offsetX, offsetY;
    
    objectElement.addEventListener('mousedown', startDrag);
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup', stopDrag);
    objectElement.addEventListener('touchstart', (e) => startDrag(e.touches[0]));
    document.addEventListener('touchmove', (e) => drag(e.touches[0]));
    objectElement.addEventListener('touchend', stopDrag);

    function startDrag(e) {
        if(objectElement.classList.contains('falling')) return; 
        isDragging = true;
        offsetX = e.clientX - objectElement.getBoundingClientRect().left;
        offsetY = e.clientY - objectElement.getBoundingClientRect().top;
        objectElement.style.transition = 'none'; 
        objectElement.style.cursor = 'grabbing';
    }

    function drag(e) {
        if (!isDragging) return;
        updateDimensions(); 

        const containerRect = beakerContainer.getBoundingClientRect();
        
        let newX = e.clientX - containerRect.left - offsetX;
        let newY = e.clientY - containerRect.top - offsetY;

        newX = Math.max(0, Math.min(newX, containerRect.width - objectSize));
        newY = Math.max(waterSurfaceTop, Math.min(newY, beakerHeight - objectSize)); 

        objectElement.style.left = `${newX}px`;
        objectElement.style.top = `${newY}px`;
    }

    function stopDrag() {
        if (!isDragging) return;
        isDragging = false;
        objectElement.style.cursor = 'pointer';
        
        simulateArchimedes(selectElement.value); 
    }
</script>

</body>
</html>